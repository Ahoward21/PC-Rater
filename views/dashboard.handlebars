<section>
  <h2>Create New Post</h2>

  <form class="new-post-form">
    <div>
      <label for="post-title">Title</label>
      <input type="text" id="post-title" name="post-title" />
    </div>
    <div>
      <input id="post-url" name="post-url" type="hidden"/>
    </div>
    <div>
      <label for="post-description">Description</label>
      <input id="post-description" name="post-description" />
    </div>
    <button type="submit" class="btn">Create</button>
  </form>
</section>

<button id="upload_widget" class="cloudinary-button">Upload files</button>

<script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>  

<script type="text/javascript">  
var myWidget = cloudinary.createUploadWidget({
  cloudName: 'pc-rater',
  uploadPreset: 'my_preset' }, 
   (error, result) => { 
    if (!error && result && result.event === "success") { 
      console.log('Done! Here is the image info: ', result.info);
      var inputBox = document.getElementById('post-url');
      inputBox.value = result.info.url;
      console.log(inputBox.value);
      var imageConatiner = document.getElementById('image-container');
      var imageRender = document.createElement('img');
      imageRender.setAttribute('src', inputBox.value);
      imageConatiner.appendChild(imageRender);
    }
   }
)

document.getElementById("upload_widget").addEventListener("click", function(){
    myWidget.open();
  }, false);
</script>

<div id="image-container"></div>

{{#if posts.length}}
<section>
  <h2>Your Posts</h2>
  <ol>
    {{#each posts as |post|}}
    <li>
      {{> post-info post}}
      <a href="/dashboard/edit/{{post.id}}" class="edit-link">Edit post</a>
    </li>
    {{/each}}
  </ol>
</section>
{{/if}}

<script src="/javascript/add-post.js"></script>